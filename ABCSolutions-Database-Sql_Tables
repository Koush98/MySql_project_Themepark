-- Create database named ABCSolutions
CREATE DATABASE ABCSolutions;
SHOW DATABASES;
USE ABCSolutions;

-- Create a simple table named countries
CREATE TABLE countries (
    country_id VARCHAR(4),
    country_name VARCHAR(50),
    regionid DECIMAL(12,0)
);
SHOW TABLES;

-- Create a simple table countries if it does not already exist
CREATE TABLE IF NOT EXISTS countries (
    country_id VARCHAR(2),
    country_name VARCHAR(50),
    regionid DECIMAL(12,0)
);

-- Create the structure of a table dup_countries similar to countries
CREATE TABLE IF NOT EXISTS dup_countries LIKE countries;
SHOW TABLES;

-- Create the structure of table dup_countries similar to countries with data
CREATE TABLE IF NOT EXISTS dup_countries AS SELECT * FROM countries;
DROP TABLE countries;

-- Create a table countries with NOT NULL constraints
CREATE TABLE IF NOT EXISTS countries (
    country_id VARCHAR(4) NOT NULL,
    country_name VARCHAR(50) NOT NULL,
    regionid DECIMAL(12,0) NOT NULL
);

-- Create a table named jobs with a check constraint on max_salary
CREATE TABLE IF NOT EXISTS jobs (
    job_id VARCHAR(12),
    job_title VARCHAR(40) NOT NULL,
    min_salary DECIMAL(7,0),
    max_salary DECIMAL(7,0) CHECK (max_salary <= 25000)
);
SHOW TABLES;

DROP TABLE countries;

-- Create a table named countries with a check constraint on country_name
CREATE TABLE IF NOT EXISTS countries (
    country_id VARCHAR(4),
    country_name VARCHAR(50) CHECK (country_name IN ('Italy', 'India', 'China')),
    regionid DECIMAL(12,0)
);

-- Create a table named job_history with a check constraint on end_date format
CREATE TABLE IF NOT EXISTS job_history (
    employee_id DECIMAL(7,0) NOT NULL,
    start_date DATE NOT NULL,
    end_date DATE NOT NULL CHECK (end_date LIKE '--/--/----'),
    job_id VARCHAR(15) NOT NULL,
    dept_id DECIMAL(5,0) NOT NULL
);

-- Create a table named countries with a unique constraint on country_id
ALTER TABLE countries
ADD UNIQUE (country_id);

DROP TABLE jobs;

-- Create a table named jobs with default values for job_title, min_salary, and max_salary
CREATE TABLE jobs (
    job_id VARCHAR(12) NOT NULL UNIQUE,
    job_title VARCHAR(20) NOT NULL DEFAULT '',
    min_sal DECIMAL(7,0) DEFAULT 8000,
    max_sal DECIMAL(7,0) DEFAULT NULL
);

DROP TABLE countries;

-- Create a table named countries with country_id as a unique primary key
CREATE TABLE IF NOT EXISTS countries (
    country_id VARCHAR(4) NOT NULL UNIQUE PRIMARY KEY,
    country_name VARCHAR(50) NOT NULL,
    regionid DECIMAL(12,0) NOT NULL
);

-- Create a table named countries with country_id as an auto-incremented unique primary key
CREATE TABLE IF NOT EXISTS countries (
    country_id INTEGER NOT NULL UNIQUE AUTO_INCREMENT PRIMARY KEY,
    country_name VARCHAR(50) NOT NULL,
    regionid DECIMAL(12,0) NOT NULL
);
DESC countries;

-- Create a table named countries with a unique combination of country_id and regionid
CREATE TABLE IF NOT EXISTS countries (
    country_id VARCHAR(4) NOT NULL UNIQUE DEFAULT '',
    country_name VARCHAR(50) DEFAULT NULL,
    regionid DECIMAL(12,0) NOT NULL,
    PRIMARY KEY (country_id, regionid)
);

DROP TABLE job_history;

-- Create table job_history with a unique foreign key job_id
CREATE TABLE job_history (
    employeeid DECIMAL(7,0) NOT NULL PRIMARY KEY,
    start_date DATE NOT NULL,
    end_date DATE NOT NULL,
    job_id VARCHAR(12) NOT NULL,
    dept_id DECIMAL(5,0) DEFAULT NULL,
    FOREIGN KEY (job_id) REFERENCES jobs(job_id)
);

-- Create a table employees with various constraints
CREATE TABLE IF NOT EXISTS employees (
    employee_id DECIMAL(7,0) NOT NULL PRIMARY KEY,
    first_name VARCHAR(30) DEFAULT NULL,
    last_name VARCHAR(30) DEFAULT NULL,
    email VARCHAR(30) NOT NULL,
    phone_number VARCHAR(25) DEFAULT NULL,
    hire_date DATE NOT NULL,
    job_id VARCHAR(15) NOT NULL,
    salary DECIMAL(9,2) DEFAULT NULL,
    commission_pct DECIMAL(3,2) DEFAULT NULL,
    manager_id DECIMAL(7,0) DEFAULT NULL,
    department_id DECIMAL(5,0) DEFAULT NULL,
    FOREIGN KEY (department_id, manager_id) REFERENCES departments(department_id, manager_id)
);
SHOW TABLES;
DROP TABLE employees, departments;

-- Recreate departments table
CREATE TABLE departments (
    department_id DECIMAL(5,0) PRIMARY KEY,
    department_name VARCHAR(35) NOT NULL,
    manager_id DECIMAL(7,0),
    location_id DECIMAL(5,0)
);

DESC jobs;

-- Recreate employees table with various constraints and foreign keys
CREATE TABLE employees (
    employee_id DECIMAL(7,0) NOT NULL PRIMARY KEY,
    first_name VARCHAR(30) DEFAULT NULL,
    last_name VARCHAR(30) NOT NULL,
    email VARCHAR(30) NOT NULL,
    phone_number VARCHAR(25) DEFAULT NULL,
    hire_date DATE NOT NULL,
    job_id VARCHAR(15) NOT NULL,
    salary DECIMAL(9,2) DEFAULT NULL,
    commission_pct DECIMAL(6,0) DEFAULT NULL,
    manager_id DECIMAL(6,0) DEFAULT NULL,
    department_id DECIMAL(5,0) DEFAULT NULL,
    FOREIGN KEY (department_id) REFERENCES departments(department_id),
    FOREIGN KEY (job_id) REFERENCES jobs(job_id)
);

DROP TABLE employees;

-- Recreate employees table with cascading deletes and restricted updates
CREATE TABLE employees (
    employee_id DECIMAL(7,0) NOT NULL PRIMARY KEY,
    first_name VARCHAR(30) DEFAULT NULL,
    last_name VARCHAR(30) NOT NULL,
    job_id VARCHAR(12) NOT NULL,
    salary DECIMAL(9,2) DEFAULT NULL,
    FOREIGN KEY (job_id) REFERENCES jobs(job_id)
    ON DELETE CASCADE
    ON UPDATE RESTRICT
);

-- Recreate employees table with set null on delete and update
CREATE TABLE employees (
    employee_id DECIMAL(7,0) NOT NULL PRIMARY KEY,
    first_name VARCHAR(30) DEFAULT NULL,
    last_name VARCHAR(30) NOT NULL,
    job_id VARCHAR(12) NOT NULL,
    salary DECIMAL(9,2) DEFAULT NULL,
    FOREIGN KEY (job_id) REFERENCES jobs(job_id)
    ON DELETE SET NULL
    ON UPDATE SET NULL
);

DROP TABLE employees;
DROP TABLE job_history;
DROP TABLE jobs;

-- Recreate employees table with no action on delete and update
CREATE TABLE employees (
    employee_id DECIMAL(7,0) NOT NULL PRIMARY KEY,
    first_name VARCHAR(30) DEFAULT NULL,
    last_name VARCHAR(30) NOT NULL,
    job_id INTEGER NOT NULL,
    salary DECIMAL(9,2) DEFAULT NULL,
    FOREIGN KEY (job_id) REFERENCES jobs(job_id)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);
